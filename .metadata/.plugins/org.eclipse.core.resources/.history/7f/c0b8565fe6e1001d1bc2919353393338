<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ page import="java.io.*,java.util.*,org.apache.commons.fileupload.*,org.apache.commons.fileupload.disk.*,org.apache.commons.fileupload.servlet.*" %>
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
	
<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
<title>ì‚½ì…ìˆ </title>
<script  src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="../projectResources/javascript/Insert.js"></script>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
	crossorigin="anonymous">
<link rel="styleSheet" href="../projectResources/css/RecipeInsert.css">
<script>
</script>
</head>
<body onload="init()">
<jsp:include page="../projectResources/Header.jsp" flush="false"/>
	<c:if test="${sessionScope.user==null }">
		<script type="text/javascript">
			alert('ê¸€ì“°ê¸°ëŠ” ë¡œê·¸ì¸ì„ í•´ì•¼í•©ë‹ˆë‹¤.');
			location.href='../project/loginCheck.do'; 
		</script>
	</c:if> 
	<div class="insert_form">
	<form action="../project/RecipeEdit.do" method="post" onsubmit="return validateForm(this)" enctype="multipart/form-data">
	<input name="user_idx" type="text" value="${sessionScope.user.user_idx}"/>
	<input name="recipe_id" type="hidden" value="${recipe_id}">
	<h3>${sessionScope.user.user_idx}</h3>
		<div class="insert_form_title">
			<b>ë ˆì‹œí”¼ ë“±ë¡</b>
		</div>
		<div class="insert_summary">
			<div class="summary_title">
				ë ˆì‹œí”¼ ì œëª© <input type="text" style="width: 610px;"
					placeholder="ì˜ˆ ) ì†Œê³ ê¸° ë¯¸ì—­êµ­ ë“ì´ê¸°" name="recipe_name" value="${recipeDto.recipe_name}">
			</div>
			<div class="summary_describe">
				ìš”ë¦¬ ì†Œê°œ <textarea name="recipe_desc"
					style="height: 100px; width: 610px; resize: none;"
					placeholder="ì´ ë ˆì‹œí”¼ì˜ íƒ„ìƒë°°ê²½ì„ ì ì–´ì£¼ì„¸ìš”. ì˜ˆ) ë‚¨í¸ì˜ ìƒì¼ì„ ë§ì•„ ì†Œê³ ê¸° ë¯¸ì—­êµ­ì„ ë“ì—¬ë´¤ì–´ìš”. ì–´ë¨¸ë‹ˆë¡œë¶€í„° ë°°ìš´ ë¯¸ì—­êµ­ ë ˆì‹œí”¼ë¥¼ ë‚¨í¸ì˜ ì…ë§›ì— ë§ê²Œ ê³ ì•ˆí–ˆìŠµë‹ˆë‹¤.">${recipeDto.recipe_desc}</textarea>
			</div>
			<div>
<!-- 			<img id="mainPhotoHolder" onclick="browseMainFile()" src="../projectResources/img/camera.jpg" -->
<!--                   style="width: 250px; height: 250px; cursor:pointer"> -->
<!-- 				<input type="file" name="mainPhotoUpload" class="mainPhotoUpload" id="mainPhotoUpload" style="display: none;"> -->
<%-- 				<img id="mainPhotoHolder" onclick="browseMainFile()" src="${pageContext.request.contextPath}/Storage/${recipeDto.recipe_image_url}" style="width: 250px; height: 250px; cursor:pointer"> --%>
<!-- 				<input type="file" id="inputFile" onchange="loadFile(event)" style="display:none"> -->
				<img id="mainPhotoHolder" src="${pageContext.request.contextPath}/Storage/${recipeDto.recipe_image_url}" style="width: 250px; height: 250px; cursor:pointer">
				<input type="file" id="inputFile" name="mainPhotoUpload" onchange="loadMainFile(event)" style="display:none">
				
			</div>
			<div class="summary_category">
				<b>ì¹´í…Œê³ ë¦¬</b> <select name="select_category_1" id="select_category_1">
					<optgroup>
						<option>ì¢…ë¥˜ë³„</option>
						<option value="1">ë°‘ë°˜ì°¬</option>
						<option value="2">ë©”ì¸ë°˜ì°¬</option>
						<option value="3">êµ­/íƒ•</option>
						<option value="4">ì°Œê°œ</option>
						<option value="5">ë””ì €íŠ¸</option>
						<option value="6">ë©´/ë§Œë‘</option>
						<option value="7">ë°¥/ì£½/ë–¡</option>
						<option value="8">í“¨ì „</option>
						<option value="9">ê¹€ì¹˜/ì “ê°ˆ/ì¥ë¥˜</option>
						<option value="10">ì–‘ë…/ì†ŒìŠ¤/ì¼</option>
						<option value="11">ì–‘ì‹</option>
						<option value="12">ìƒëŸ¬ë“œ</option>
						<option value="13">ìŠ¤í”„</option>
						<option value="14">ë¹µ/ê³¼ì</option>
						<option value="15">ì°¨/ìŒë£Œ/ìˆ </option>
						<option value="16">ê¸°íƒ€</option>
					</optgroup>
				</select> <select name="select_category_2" id="select_category_2">
					<optgroup>
						<option>ìƒí™©ë³„</option>
						<option value="1">ì¼ìƒ</option>
						<option value="2">ì´ˆìŠ¤í”¼ë“œ</option>
						<option value="3">ì†ë‹˜ì ‘ëŒ€</option>
						<option value="4">ìˆ ì•ˆì£¼</option>
						<option value="5">ë‹¤ì´ì–´íŠ¸</option>
						<option value="6">ë„ì‹œë½</option>
						<option value="7">ì˜ì–‘ì‹</option>
						<option value="8">ê°„ì‹</option>
						<option value="9">ì•¼ì‹</option>
						<option value="10">í‘¸ë“œìŠ¤íƒ€ì¼ë§</option>
						<option value="11">í•´ì¥</option>
						<option value="12">ëª…ì ˆ</option>
						<option value="13">ì´ìœ ì‹</option>
						<option value="14">ê¸°íƒ€</option>
					</optgroup>
				</select> <select name="select_category_3" id="select_category_3">
					<optgroup>
						<option>ë°©ë²•ë³„</option>
						<option value="1">ë³¶ìŒ</option>
						<option value="2">ë“ì´ê¸°</option>
						<option value="3">ë¶€ì¹¨</option>
						<option value="4">ì¡°ë¦¼</option>
						<option value="5">ë¬´ì¹¨</option>
						<option value="6">ë¹„ë¹”</option>
						<option value="7">ì°œ</option>
						<option value="8">ì ˆì„</option>
						<option value="9">íŠ€ê¹€</option>
						<option value="10">ì‚¶ê¸°</option>
						<option value="11">êµ½ê¸°</option>
						<option value="12">ë°ì¹˜ê¸°</option>
						<option value="13">íšŒ</option>
						<option value="14">ê¸°íƒ€</option>
					</optgroup>
				</select> <select name="select_category_4" id="select_category_4">
					<optgroup label="ì¬ë£Œë³„">
						<option>ì¬ë£Œë³„</option>
						<option value="1">ì†Œê³ ê¸°</option>
						<option value="2">ë¼ì§€ê³ ê¸°ë¥˜</option>
						<option value="3">ë‹­ë¥˜</option>
						<option value="4">ìœ¡ë¥˜</option>
						<option value="5">ì±„ì†Œë¥˜</option>
						<option value="6">í•´ë¬¼ë¥˜</option>
						<option value="7">ë‹¬ê±€/ìœ ì œí’ˆ</option>
						<option value="8">ê°€ê³µì‹í’ˆë¥˜</option>
						<option value="9">ìŒ€</option>
						<option value="10">ë°€ê°€ë£¨</option>
						<option value="11">ê±´ì–´ë¬¼ë¥˜</option>
						<option value="12">ë²„ì„¯ë¥˜</option>
						<option value="13">ê³¼ì¼ë¥˜</option>
						<option value="14">ì½©/ê²¬ê³¼ë¥˜</option>
						<option value="15">ê³¡ë¥˜</option>
						<option value="16">ê¸°íƒ€</option>
					</optgroup>
				</select>
			</div>
			<br>
			<div class="summary_recipe_info">
				<p>
					<b>ìš”ë¦¬ì •ë³´</b>
				</p>
				ìš”ë¦¬ì–‘ <select name="recipe_amount" id="select_info_1">
					<optgroup label="ëª‡ì¸ë¶„ê¸°ì¤€">
						<option value="1ì¸ë¶„">1ì¸ë¶„</option>
						<option value="2ì¸ë¶„">2ì¸ë¶„</option>
						<option value="3ì¸ë¶„">3ì¸ë¶„</option>
						<option value="4ì¸ë¶„">4ì¸ë¶„</option>
						<option value="5ì¸ë¶„">5ì¸ë¶„</option>
						<option value="6ì¸ë¶„">6ì¸ë¶„ ì´ìƒ</option>
					</optgroup>
				</select> ìš”ë¦¬ì‹œê°„ <select name="recipe_cooking_time" id="select_info_2">
					<optgroup label="ì‹œê°„">
						<option>ì‹œê°„</option>
						<option value="5ë¶„ ì´ë‚´">5ë¶„ ì´ë‚´</option>
						<option value="10ë¶„ ì´ë‚´">10ë¶„ ì´ë‚´</option>
						<option value="15ë¶„ ì´ë‚´">15ë¶„ ì´ë‚´</option>
						<option value="20ë¶„ ì´ë‚´">20ë¶„ ì´ë‚´</option>
						<option value="30ë¶„ ì´ë‚´">30ë¶„ ì´ë‚´</option>
						<option value="60ë¶„ ì´ë‚´">60ë¶„ ì´ë‚´</option>
						<option value="90ë¶„ ì´ë‚´">90ë¶„ ì´ë‚´</option>
						<option value="2ì‹œê°„ ì´ë‚´">2ì‹œê°„ ì´ë‚´</option>
						<option value="2ì‹œê°„ ì´ìƒ">2ì‹œê°„ ì´ìƒ</option>
					</optgroup>
				</select> ìš”ë¦¬ë‚œì´ë„ <select name="recipe_difficulty" id="select_info_3">
					<optgroup label="ë‚œì´ë„">
						<option>ë‚œì´ë„</option>
						<option value="ì•„ë¬´ë‚˜">ì•„ë¬´ë‚˜</option>
						<option value="ì´ˆê¸‰">ì´ˆê¸‰</option>
						<option value="ì¤‘ê¸‰">ì¤‘ê¸‰</option>
						<option value="ê³ ê¸‰">ê³ ê¸‰</option>
						<option value="ì‹ ì˜ ê²½ì§€">ì‹ ì˜ ê²½ì§€</option>
					</optgroup>
				</select>
			</div>
		</div>
		<br>
		<br>
		<div class="insert_ingredients">
			<span style="width: 100%;">ì¬ë£Œê°€ ë‚¨ê±°ë‚˜ ë¶€ì¡±í•˜ì§€ ì•Šë„ë¡ ì •í™•í•œ ê³„ëŸ‰ì •ë³´ë¥¼ ì ì–´ì£¼ì„¸ìš”.</span>
			<div class="ingredient_group_div">
				<li style="list-style-type: none;">
					<!-- <p>
						<input type="text" name="ingredient_group_title_1" value="ì¬ë£Œ"
							style="font-weight: bold; font-size: 18px; width: 210px;"/>
					</p> -->
<!-- 					<ul id="ingredient_group_list"> -->
<!-- 						<li class="ingreTextList" id="ingredient_text_list1"> -->
<!-- 							<input name="ingredient_name[]" type="text" class="ingreInput" placeholder="ì˜ˆ)ë¼ì§€ê³ ê¸°"></input>  -->
<!-- 							<input name="ingredient_amount[]" type="text" class="ingreInput"  placeholder="ì˜ˆ)300g"></input> -->
<!-- 							<img id="ingredient_text_list1_delBtn" class="ingreDelBtn" src="../projectResources/img/x-mark.png"> -->
<!-- 						</li> -->
<!-- 					</ul> -->
					<ul id="ingredient_group_list">
	                  <c:forEach var="ingre" items="${ingreList}">
	                  	<li class="ingreTextList" id="ingredient_text_list1">
		                  	<input name="ingredient_name[]" type="text" class="ingreInput" placeholder="ì˜ˆ)ë¼ì§€ê³ ê¸°" value="${ingre.ingredient_name}"></input> 
							<input name="ingredient_amount[]" type="text" class="ingreInput" placeholder="ì˜ˆ)300g" value="${ingre.ingredient_amount}"></input>
							<img id="ingredient_text_list1_delBtn" class="ingreDelBtn" src="../projectResources/img/x-mark.png">
	                    </li>
	                  </c:forEach>
	               </ul>
	               
	               
					<div style="padding-left:12%">
						<button type="button" id="addIngredientGroup" class="btn btn-outline-success">ì¶”ê°€</button>
					</div>
				</li>
			</div>
		</div>
		<div class="add_ingredient_group">
		
			<span>â€» ì–‘ë…, ì–‘ë…ì¥, ì†ŒìŠ¤, ë“œë ˆì‹±, í† í•‘, ì‹œëŸ½, ìœ¡ìˆ˜ ë°‘ê°„ ë“±ìœ¼ë¡œ êµ¬ë¶„í•´ì„œ ì‘ì„±í•´ì£¼ì„¸ìš”.</span><br>
			
		</div>
		
		<br><br>
		
		<div class="recipe_step_form">
			<div class="recipe_step_title">
				<p class="cont_tit3" style="font-weight: bold">
					ìš”ë¦¬ìˆœì„œ
				</p>
			</div>
			<div class="recipe_step_guide">
				<span class="guide mag_b_15"><b>ìš”ë¦¬ì˜ ë§›ì´ ì¢Œìš°ë  ìˆ˜ ìˆëŠ” ì¤‘ìš”í•œ ë¶€ë¶„ì€ ë¹ ì§ì—†ì´ ì ì–´ì£¼ì„¸ìš”.</b><br>
					ì˜ˆ) 10ë¶„ê°„ ìµí˜€ì£¼ì„¸ìš” â–· 10ë¶„ê°„ ì•½í•œë¶ˆë¡œ ìµí˜€ì£¼ì„¸ìš”.<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ë§ˆëŠ˜í¸ì€ ìµí˜€ì£¼ì„¸ìš” â–· ë§ˆëŠ˜í¸ì„ ì¶©ë¶„íˆ ìµí˜€ì£¼ì…”ì•¼ ë§¤ìš´ ë§›ì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.<br>
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ê¿€ì„ ì¡°ê¸ˆ ë„£ì–´ì£¼ì„¸ìš” â–· ê¿€ì´ ì—†ëŠ” ê²½ìš°, ì„¤íƒ• 1ìŠ¤í‘¼ìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•©ë‹ˆë‹¤.
	  			</span>
			</div>
			<div class="recipe_step_detail">
				<br>
				<div class="row step_row">
					<c:forEach var="stepList" items="${stepList}">
						<div class="step_div" id="step_div1">
							<p class="step_p">ğŸ”»</p>
							<div id="step_div_text1">
								<textarea name="step_text[]" class="form-control step_cont" placeholder="ì˜ˆ) ì†Œê³ ê¸°ëŠ” ê¸°ë¦„ê¸°ë¥¼ ë–¼ì–´ë‚´ê³  ì ë‹¹í•œ í¬ê¸°ë¡œ ì°ì–´ì£¼ì„¸ìš”.">${stepList.step_desc}</textarea>
							</div>
							<div id="step_div_photo1">
								<img name="step_img_photo[]" id="step_img_photo1" class="stepDivPhoto" src="${pageContext.request.contextPath}/Storage/${stepList.step_image_url}" style="width: 150px;height: 150px;">
	  							<input type="file" name="fileUpload" class="fileUpload" id="fileUpload1" style="display: none;" multiple="multiple" onchange="displayImage(event, this)">
	  						</div>
	  										
	  						<img id="step_div_text1_delBtn" class="stepDelBtn" src="../projectResources/img/file-x.svg">
	  						<br>	  						
		                       
						</div>
					</c:forEach>
				</div>
				<div style="padding-left: 15%">
					<button type="button" class="btn btn-outline-primary" id="addStepDetailGroup" style="border: 1px solid grey">ìˆœì„œ ì¶”ê°€</button>
				</div>
			</div>
			<br>			
			<br>
		</div>
		<!-- <div class="recipe_step_donePhotos">
				<p style="font-weight: bold; font-size: 15px">ìš”ë¦¬ ì™„ì„± ì‚¬ì§„</p>
				<img src="../projectResources/img/imageAdd.png" id="stepPhotoHolder_1" onclick="uploadFile()" src="" width="120" height="120" style="cursor:pointer">
				
			</div> -->
		<div class="recipe_tips">
			<p>ìš”ë¦¬íŒ</p>
		</div>
		
		<button type="submit">ì €ì¥</button>
		<button type="reset">ì´ˆê¸°í™”</button>
		<button type="button" onclick="">ì·¨ì†Œ</button>
	</form>
	</div> 
	


</body>
<script>
		//ìš”ë¦¬ëŸ‰, ìš”ë¦¬ì‹œê°„, ë‚œì´ë„ ì„ íƒì ë°ì´í„° ì ìš©
        function setSelectValue(selectId, value) {
            const select = document.getElementById(selectId);
            const options = Array.from(select.options);

            // ì¼ì¹˜í•˜ëŠ” ê°’ì„ ì°¾ì€ ê²½ìš° í•´ë‹¹ optionì„ ì„ íƒí•©ë‹ˆë‹¤.
            const matchedOption = options.find(option => option.value === value);
            if (matchedOption) {
                select.value = value;
            } else {
                // ì¼ì¹˜í•˜ëŠ” ê°’ì„ ì°¾ì§€ ëª»í•œ ê²½ìš° ì²« ë²ˆì§¸ optionì„ ì„ íƒí•©ë‹ˆë‹¤.
                select.selectedIndex = 0;
            }
        }
        function init() {
            // ì´ ë¶€ë¶„ì—ì„œ ì‹¤ì œ ê°’ìœ¼ë¡œ ëŒ€ì²´í•´ì•¼ í•©ë‹ˆë‹¤.
            const recipe_people = '${recipeDto.recipe_people}';
            const recipe_time = '${recipeDto.recipe_time}';
            const recipe_difficulty = '${recipeDto.recipe_difficulty}';

            setSelectValue('select_info_1', recipe_people);
            setSelectValue('select_info_2', recipe_time);
            setSelectValue('select_info_3', recipe_difficulty);
        }
        
        
        
        
        window.addEventListener('DOMContentLoaded', (event) => {
            const mainPhotoHolder = document.getElementById('mainPhotoHolder');
            const inputFile = document.getElementById('inputFile');

            mainPhotoHolder.addEventListener('click', () => {
                inputFile.click();
            });

            inputFile.addEventListener('change', loadMainFile);

            // í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì—¬ ì´ë¯¸ì§€ íŒŒì¼ ì •ë³´ë¥¼ inputì— ìë™ ì ìš©
            applyImageInfo();
        });

        function loadMainFile(event) {
            const mainPhotoHolder = document.getElementById('mainPhotoHolder');
            const file = event.target.files[0];
            const reader = new FileReader();

            reader.onload = function(e) {
                mainPhotoHolder.src = e.target.result;
            };

            reader.readAsDataURL(file);
        }

        function applyImageInfo() {
            const mainPhotoHolder = document.getElementById('mainPhotoHolder');
            const inputFile = document.getElementById('inputFile');
            const imagePath = mainPhotoHolder.src;

            // ì´ë¯¸ì§€ íŒŒì¼ì˜ ì´ë¦„ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
            const imageName = imagePath.split('/').pop();

            // inputì— ì´ë¯¸ì§€ ì •ë³´ë¥¼ ì ìš©í•©ë‹ˆë‹¤.
            inputFile.value = imageName;
        }
        
      
        
        
        
        
//         //ì¡°ë¦¬ë°©ë²• ì‚¬ì§„ íŒŒì¼ìƒíƒœ ì ìš©
//         function displayImage(event, input) {
//     		event.stopPropagation();
//             // íŒŒì¼ì´ ì„ íƒë˜ì—ˆëŠ”ì§€ í™•ì¸
//             if (input.files && input.files[0]) {
//                 // ìƒˆ FileReader ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
//                 const reader = new FileReader();

//                 // FileReaderì— onload ì½œë°± ì„¤ì •
//                 reader.onload = function (e) {
//                     // input idì— í•´ë‹¹í•˜ëŠ” ì´ë¯¸ì§€ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
//                     const imgId = input.id.replace("fileUpload", "step_img_photo");
//                     const img = document.getElementById(imgId);

//                     // ì´ë¯¸ì§€ì˜ src ì†ì„±ì„ FileReader ê²°ê³¼ë¡œ ì—…ë°ì´íŠ¸
//                     img.src = e.target.result;
//                 };

//                 // ì„ íƒëœ ì´ë¯¸ì§€ íŒŒì¼ì„ Data URLë¡œ ì½ê¸°
//                 reader.readAsDataURL(input.files[0]);
//             }
//         }
        
        
       

</script>
</html>